import matplotlib.pyplot as plt
import numpy as np
import matplotlib.pyplot as plt

def pareto_frontier(xs, ys):
    points = sorted(zip(xs, ys))  # sort by x ascending
    frontier = []
    best_y = float('inf')
    for x, y in points:
        if y < best_y:
            frontier.append((x, y))
            best_y = y
    return zip(*frontier)

#x =  [37.38174273858921, 31.57894736842105, 25.423728813559322, 25.423728813559322, 37.24920534011443, 37.38174273858921, 31.57894736842105, 38.01472908995266, 39.02395447326628, 39.10595744680851, 37.24920534011443, 36.32118644067797, 33.79858156028369, 34.729468599033815, 37.38174273858921, 32.644755244755245, 37.24920534011443, 34.559006211180126, 36.32118644067797, 31.677725118483412, 36.32118644067797, 38.17734408145948, 35.91820224719101, 35.9952805453592, 37.24920534011443, 52.88945362134689, 47.69790382244143, 51.1611030478955, 49.450244698205545, 47.72050816696915, 58.05156136528686, 56.32667876588022, 52.20258935083881, 50.682257244534824, 62.317241379310346, 63.213165572574766, 61.491087668243, 59.130237620170504, 59.10047152702212, 61.390583903208835, 63.213165572574766, 60.82257476294676, 64.06969619606842, 64.20478868129875, 85.77635945876946, 62.30183203337566, 62.37676093634149, 62.48340425531915, 62.514420460729184, 62.37676093634149]
#y =  [45.461465785281185, 60.678935361891895, 71.21408920522121, 71.21408920522121, 145.23501555344785, 45.461465785281185, 60.678935361891895, 193.88209066108718, 193.28857792734, 144.83452249260867, 145.23501555344785, 145.4352620838674, 145.9769762529089, 145.77672972248934, 45.461465785281185, 154.10076167549343, 145.23501555344785, 153.63621394922984, 145.4352620838674, 154.33303553862524, 145.4352620838674, 145.03476902302825, 236.70968419388115, 195.06911612858153, 145.23501555344785, 140.6479643218604, 149.23994616183944, 140.6799916545726, 140.7120189872848, 140.74404631999704, 140.55188232372376, 140.58390965643596, 238.08356149713566, 238.97621836282758, 52.012678051130095, 140.45580032558715, 140.48782765829935, 228.86655904500992, 228.89858637772213, 181.59433390313637, 140.45580032558715, 221.19013453953454, 328.1982593778937, 228.86655904500992, 327.8370205072783, 288.1874076871169, 287.96217914365866, 228.89858637772215, 228.86655904500992, 287.96217914365866]

# alpha = 0.1

ox1 =  [21.991491267353336, 23.196961196820943, 26.78970580549055, 26.65085720331789, 26.27482063228215, 21.991491267353336, 21.887324278680335, 22.83530952709224, 22.407971339005822, 27.529251421683384, 25.657859381997312, 26.48410210479176, 25.33043821555468, 26.353512047762898, 27.368133382840725, 30.493443122903326, 32.17426125624962, 34.07845569974593, 31.293202478404414, 30.977803591611202, 38.25795505607965, 35.58289182482731, 44.571116325801015, 38.14029989538533, 38.97058253058951, 40.69757098871023, 40.777276147479306, 42.73918583596003, 52.27089156827569, 43.379089166244526, 47.255582784544174, 46.38720141551165, 47.97381640085395, 47.25344776872888, 47.97445390596076, 49.66627211430745, 50.9255339545228, 58.25075445730897, 51.41128877641014, 58.16212956227877]
oy1 =  [20.443306511249464, 30.247668808873783, 26.31394630771385, 29.17125858239055, 50.17649775312778, 20.443306511249464, 26.978130085670372, 31.571262881148755, 23.28875609438204, 26.698498421755993, 19.328619735281283, 19.155744554960116, 21.285370267302383, 23.33300710544605, 26.240192894572928, 22.153616629475152, 26.726040573224005, 27.50395132425961, 26.275131091777318, 26.422640745599406, 26.806568768843164, 35.59370659468905, 32.18623615313731, 43.70655638048983, 32.60927730401656, 22.618937754877802, 22.934067497843884, 28.05322194892601, 29.007796684868573, 28.218829619604676, 30.40151406491733, 38.929585667255594, 28.862259242315844, 35.13024526024557, 33.74054742738558, 28.011787064145498, 32.584477051149534, 39.610303553597106, 32.68489028580466, 34.494015583826744]
x1 =[]
y1=[]

for i in range(len(ox1)):
    if ox1[i]<22:
        continue

    x1.append(ox1[i])
    y1.append(oy1[i])

# alpha = 0.5
ox2 =  [21.991491267353336, 22.407971339005822, 23.196961196820943, 22.071501629361812, 26.78970580549055, 21.991491267353336, 21.887324278680335, 27.33477409753621, 23.433049708911778, 22.071501629361812, 26.264343391415213, 25.41692789968652, 27.075260208166533, 24.535602328705778, 25.66140500241607, 28.997446808510638, 28.441140329319243, 29.99255583126551, 31.1112532712998, 30.06862249199123, 37.76220170284207, 37.331611875303096, 35.58289182482731, 40.0400527641204, 39.172902342265616, 46.313669471304785, 40.52663388895551, 42.77259380097879, 40.0400527641204, 45.87405444658032, 46.70364847400338, 43.72596234560499, 44.44528082032161, 46.003798934493496, 45.98445881837247, 51.974933575003604, 50.959712467302424, 49.66627211430745, 50.02227846159745, 52.8431987621524]
oy2 =  [20.443306511249464, 23.28875609438204, 30.247668808873783, 27.04835942714044, 26.31394630771385, 20.443306511249464, 26.978130085670372, 22.086110397578842, 20.767952130827084, 27.04835942714044, 19.65623203102426, 19.85573023521382, 19.432491804953195, 20.031254223580405, 22.589160169080614, 21.838419158788195, 21.84447531423041, 25.260070816022193, 27.764524650250472, 25.153404393242685, 22.79135700458836, 28.03834238665267, 35.59370659468905, 28.84962808881314, 27.793288640370687, 25.51179812833305, 28.810294574968882, 25.873988199657234, 28.84962808881314, 27.782465603821088, 20.46469335925987, 23.14870449010258, 25.800633274672734, 25.78321743499375, 25.873950111638045, 25.11350902387478, 27.92245886501035, 28.011787064145498, 28.95766659359307, 29.595807335717346]
x2 =[]
y2=[]
for i in range(len(ox2)):
    if ox2[i]<22.5:
        continue
    x2.append(ox2[i])
    y2.append(oy2[i])

x3 =[]
y3=[]
# alpha = 1
ox3 =  [21.991491267353336, 23.433049708911778, 26.807350326645828, 26.276926025653896, 24.112852664576803, 21.991491267353336, 27.035637350745, 24.56302745255012, 24.112852664576803, 22.725929243170622, 26.173757277205553, 26.000733675715335, 25.33043821555468, 24.56263832070284, 27.887320926670114, 27.26641998149861, 30.35302898129301, 31.65729792913462, 31.647810718167598, 28.997446808510638, 27.26641998149861, 28.997446808510638, 40.168424766087284, 28.705882352941178, 28.441140329319243, 37.76220170284207, 38.93078306751409, 44.25664096208405, 40.89042767945167, 52.73187306579155, 47.38940589782856, 47.34547434845973, 46.77075652406747, 46.10178987044551, 48.5579573565791, 47.38940589782856, 49.85040185859601, 49.66627211430745, 48.805768249106684, 50.435890995855836]
oy3 =  [20.443306511249464, 20.767952130827084, 25.62937747289777, 24.3972954834445, 20.894563404857198, 20.443306511249464, 22.169616666242263, 22.134822384484927, 20.894563404857198, 20.617612151945515, 20.100620463851406, 21.172878453551313, 21.285370267302383, 22.054393622850586, 22.51133976654407, 20.865203370356742, 24.06365890469153, 22.95504599042071, 22.926375790673738, 21.838419158788195, 20.865203370356742, 21.838419158788195, 27.747050917467842, 22.749914505708453, 21.84447531423041, 22.79135700458836, 25.436487064568958, 27.84140907603725, 32.09700218747015, 30.893045997178852, 24.45505083003074, 25.51179812833305, 29.76895120539666, 29.81841535482643, 27.100180890011334, 24.45505083003074, 27.031563843867392, 28.011787064145498, 28.10666026846432, 27.811027297950616]

for i in range(len(ox3)):
    if ox2[i]<23.45:
        continue
    x3.append(ox3[i])
    y3.append(oy3[i])


fig = plt.figure(figsize=(8,6))
c = ["#90C9E7", "#ff7f0e", "#0D6783"]

X = np.concatenate([x1, x2, x3])
Y = np.concatenate([y1, y2, y3])

# ---- Compute the frontier ----
fx1, fy1 = pareto_frontier(x1, y1)
# ---- Plot the frontier curve ----
plt.plot(fx1, fy1, color=c[0], linewidth=1, marker='o', label=r"$\lambda$ = 0.2")
# ---- Compute the frontier ----
fx2, fy2 = pareto_frontier(x2, y2)
# ---- Plot the frontier curve ----
plt.plot(fx2, fy2, color=c[1], linewidth=1, marker='o', label=r"$\lambda$ = 0.4")
# ---- Compute the frontier ----
fx3, fy3 = pareto_frontier(x3, y3)
# ---- Plot the frontier curve ----
plt.plot(fx3, fy3, color=c[2], linewidth=1, marker='o', label=r"$\lambda$ = 0.8")





# ---- Compute the frontier ----
fx, fy = pareto_frontier(X, Y)
# ---- Plot the frontier curve ----
plt.plot(fx, fy, color='black', linewidth=1.5,linestyle='--',  dashes=(12, 8),label=" overall Frontier")


# **This is the missing line**

plt.scatter(x1, y1, s=20, color=c[0], alpha=0.1, rasterized=True)
plt.scatter(x2, y2, s=20, color=c[1], alpha=0.1, rasterized=True)
plt.scatter(x3, y3, s=20, color=c[2], alpha=0.1, rasterized=True)

plt.xlabel("Time latency (s)", fontsize=14)
plt.ylabel("Energy consumption (J)", fontsize=14)
plt.title("", fontsize=16)
plt.grid(True, linestyle='--', alpha=0.3)

plt.xlim(22, 28)
plt.ylim(15, 32)

plt.legend(loc="upper right")

plt.tight_layout()
plt.show()
fig.savefig("ablation1_1.pdf", dpi=300)